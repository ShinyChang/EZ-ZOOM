<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>Option Page</title>
		<meta name="description" content="" />
		<meta name="author" content="Shiny" />
		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico" />
		<link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
		<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
		<script type="text/javascript" src="js/indexdb.js"></script>
		<script type="text/javascript">
			$(function() {
				initIndexDB();
				var background_page = chrome.extension.getBackgroundPage();
				
				//update info
				if(localStorage.getItem("updateInfo")) {
					$("#infoDiv").append(localStorage.getItem("updateInfo")).alert();
					$("#infoDiv").bind("close", function(){
						localStorage.removeItem("updateInfo");
					});
				} else {
					$("#infoDiv").hide();
				}
				$("#minimumZoomInput").val(localStorage.getItem("minZoomLevel"));
				$("#maximumZoomInput").val(localStorage.getItem("maxZoomLevel"));
				$("#zoomStepInput").val(localStorage.getItem("zoomStep"));
				$("input:checkbox").attr("checked", (localStorage.getItem("contextMenu") === "checked"));

				//form submit
				$("form").submit(function() {

					// store option info
					localStorage.setItem("minZoomLevel", $("#minimumZoomInput").val());
					localStorage.setItem("maxZoomLevel", $("#maximumZoomInput").val());
					localStorage.setItem("zoomStep", $("#zoomStepInput").val());
					localStorage.setItem("contextMenu", $("input:checkbox").attr("checked"));

					// enable/disable context menu
					if($("input:checkbox").attr("checked") === "checked") {
						background_page.createContextMenu();
					} else {
						background_page.destoryContextMenu();
					}
					background_page.updateParameter();
				});
			});

		</script>
		<script type="text/javascript" src="js/bootstrap.min.js"></script>
	</head>
	<body>
		<div class="container-fluid">
			<div class="row-fluid">
				<div class="span12">
					<div class="page-header">
						<h1>Option Page</h1>
					</div>
					<div id="infoDiv" class="alert alert-info">
						<a class="close" data-dismiss="alert">×</a>
						<strong>Update Information!</strong>
					</div>
					<div class="row">
						<div class="span6">
							<form class="form-horizontal">
								<fieldset>
									<legend>
										System Parameters
									</legend>
									<div class="control-group">
										<label class="control-label" for="minimumZoomInput">Minimum Zoom Size</label>
										<div class="controls">
											<div class="input-append">
												<input class="input-mini" id="minimumZoomInput" value="10" type="text"><span class="add-on">%</span>
											</div>
										</div>
									</div>
									<div class="control-group">
										<label class="control-label" for="maximumZoomInput">Maximum Zoom Size</label>
										<div class="controls">
											<div class="input-append">
												<input class="input-mini" id="maximumZoomInput" value="300" type="text"><span class="add-on">%</span>
											</div>
										</div>
									</div>
									<div class="control-group">
										<label class="control-label" for="zoomStepInput">Zoom step</label>
										<div class="controls">
											<div class="input-append">
												<input class="input-mini" id="zoomStepInput" value="10" type="text"><span class="add-on">%</span>
											</div>
										</div>
									</div>
									<div class="control-group">
										<label class="control-label" for="optionsCheckbox2">Context Menu</label>
										<div class="controls">
											<label class="checkbox">
												<input type="checkbox" id="optionsCheckbox2" value="option1" checked="true">
												Enable </label>
										</div>
									</div>
									<div class="form-actions">
										<button type="submit" class="btn btn-primary">
											Save changes
										</button>
										<button class="btn">
											Cancel
										</button>
									</div>
								</fieldset>
							</form>
						</div>
						<div class="span6">
							<legend>
								Hotkeys
							</legend>
							<dl class="dl-horizontal">
								<dt>
									Zoom In
								</dt>
								<dd>
									<code>
										-
									</code>
								</dd>
								<dt>
									Zoom Out
								</dt>
								<dd>
									<code>
										+
									</code>
								</dd>
								<dt>
									Reset
								</dt>
								<dd>
									<code>
										*
									</code>
								</dd>
							</dl>
						</div>
					</div>
					<div>
						<legend>
							Database
						</legend>
						<table id="domainZoomLevelContainer" class="table table-striped table-condensed">
							<thead>
								<tr>
									<th>Domain</th>
									<th>Zoom</th>
									<th>Option</th>
								</tr>
							</thead>
							<tbody></tbody>
						</table>
					</div>
					<div class="alert">
						<a class="close" data-dismiss="alert">×</a>
						<strong>Warning!</strong> This is offline storage. Can not sync.
					</div>
					<footer class="footer" style="border-top: 1px solid #ccc; padding-top: 35px; padding-bottom: 35px;">
						<p class="pull-right" style="text-align: right;">
							<a href="#">Back to top</a>
							<br />
							<small>Powered by <a href="http://twitter.github.com/bootstrap/" target="_blank">Bootstrap</a></small>
						</p>
					</footer>
				</div>
			</div>
		</div>
	</body>
</html>
